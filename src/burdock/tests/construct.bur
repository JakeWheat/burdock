
# todo: support the shorthands for small numbers of args
#|
weird #|:: Constructor<String>|# = {
  make0: lam(): "nothing at all" end,
  make1: lam(a): "just " + tostring(a) end,
  make2: lam(a, b): tostring(a) + " and " + tostring(b) end,
  make3: lam(a, b, c): "several things" end,
  make4: lam(a, b, c, d): "four things" end,
  make5: lam(a, b, c, d, e): "five things" end,
  make : lam(args): "too many things" end
}
check:
  [weird: ] is "nothing at all"
  [weird: true] is "just true"
  [weird: 5, 6.24] is "5 and 6.24"
  [weird: true, false, 5] is "several things"
  [weird: 1, 2, 3, 4] is "four things"
  [weird: 1, 1, 1, 1, 1] is "five things"
  [weird: "a", "b", "c", true, false, 5] is "too many things"
end
|#

weird2 #|:: Constructor<String>|# = {
  make : lam(args):
    cases args:
      | empty => "nothing at all"
      | link(a,empty) => "just " + tostring(a)
      | link(a,link(b, empty)) => tostring(a) + " and " + tostring(b)
      | link(a,link(b, link(c,empty))) => "several things"
      | link(a,link(b, link(c,link(d,empty)))) => "four things"
      | link(a,link(b, link(c,link(d,link(e,empty))))) => "five things"
      | _ => "too many things"
    end
  end 
  }
check:
  [weird2: ] is "nothing at all"
  [weird2: true] is "just true"
  [weird2: 5, 6.24] is "5 and 6.24"
  [weird2: true, false, 5] is "several things"
  [weird2: 1, 2, 3, 4] is "four things"
  [weird2: 1, 1, 1, 1, 1] is "five things"
  [weird2: "a", "b", "c", true, false, 5] is "too many things"
end

# check creating a type and a construct to go with it

data list1:
  | link1(first, rest)
  | empty1
end

list1 #|:: Constructor<String>|# = {
  make : lam(args):
    cases args:
      | empty => "xnothing at all"
      | link(a,empty) => "xjust " + tostring(a)
      | link(a,link(b, empty)) => tostring(a) + " xand " + tostring(b)
      | link(a,link(b, link(c,empty))) => "xseveral things"
      | link(a,link(b, link(c,link(d,empty)))) => "xfour things"
      | link(a,link(b, link(c,link(d,link(e,empty))))) => "xfive things"
      | _ => "xtoo many things"
    end
  end 
  }
check:
  [list1: ] is "xnothing at all"
  [list1: true] is "xjust true"
  [list1: 5, 6.24] is "5 xand 6.24"
  [list1: true, false, 5] is "xseveral things"
  [list1: 1, 2, 3, 4] is "xfour things"
  [list1: 1, 1, 1, 1, 1] is "xfive things"
  [list1: "a", "b", "c", true, false, 5] is "xtoo many things"
end

random-thing = 4

data random-thing:
  | xxxxx
end

#data random-thing:
#  | xxxxx
#end
