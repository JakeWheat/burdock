
# test the ffi example, plus temporarily the python until the concurrency is fixed

include filesystem
import from lists:
  map,
  filter,
  not-elem
end

include testing

fun my-ld(dir):
  glob(dir + "**/*.bur") + glob(dir + "**/*.rst")
end

srcs = [list: "examples/load-csv-python.bur"]
       + my-ld("packages/ffitypes-test")
       + my-ld("packages/python-ffi")


ts = run-tests-with-opts(default-test-opts.{test-sources:map(file-test(_), srcs),
                                       show-progress-log:true,
                                       auto-print-results:true,
                                       hide-successes:true
                                      })

when has-test-failures(ts):
  _internals.sysexit(1)
end
