
use package "packages/sqlite"

include sqlite.sqlite
#|
fun g():
 raise("denied")
end

fun f():
  g()
end

check "tmp":
  1 is f()
  2 is 4
  raise("fail")
end


check "fail":
  1 is 2
end
|#
check "trivial":
  #open("1")
  #1 is 44
#|
  h = open(":memory:")
  command(h, "create table t1(a int)", empty)
  fun fi(i):
    command(h, "insert into t1 values (?)", [list: sql-integer(i)])
  end
  map(fi, [list: 1,2,3,4])

  rs = query(h, "select * from t1", empty)
  fun lp():
    v = next-row(rs)
    cases v:
      | some(r) =>
          link(r, lp())
      | none => empty
    end
  end
  lst = lp()
  lst is map(sql-integer, [list: 1,2,3,4])
  close-result(rs)
  close(h)
|#
end
